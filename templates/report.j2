{{ ansible_managed | comment }}

instance_units:
{{ instances_on_host | to_nice_yaml(sort_keys=false) }}

{% if autonames  == true %}
instance_names:
{{ list_instance_names | list | to_nice_yaml(sort_keys=false) }}
{% endif %}

http:
{{ list_http | to_nice_yaml(sort_keys=false) }}

pg:
{{ list_pg | to_nice_yaml(sort_keys=false) }}

bin:
{{ list_bin | to_nice_yaml(sort_keys=false) }}

properties:
  autonames: {{ autonames }}
  role_ver: {{ role_ver }}
  ver_fd: {{ ver_fd | default('2') }}
  picodata_version: {{ picodata_version }}
  peer_list: {{ peer_list }}
  tiers:
{% for name, conf in tiers.items() %}
    {{ name }}:
      instances_per_server: {{ dict_instances_per_server[name]|int}}
{% endfor %}
